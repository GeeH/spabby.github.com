
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>ZF2 Gary Hockin Technical Blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Le styles -->
    <link href="/css/bootstrap.min.css" media="screen" rel="stylesheet" type="text/css">
<link href="/css/style.css" media="screen" rel="stylesheet" type="text/css">
<link href="/css/bootstrap-responsive.min.css" media="screen" rel="stylesheet" type="text/css">
<link href="/images/favicon.ico" rel="shortcut icon" type="image/vnd.microsoft.icon">
    <!-- Scripts -->
    <script type="text/javascript" src="/js/jquery-1.7.2.min.js"></script>
<!--[if lt IE 9]> <script type="text/javascript" src="/js/html5.js"></script><![endif]-->
</head>

<body>

<!--<div class="navbar navbar-fixed-top">-->
<!--    <div class="navbar-inner">-->
<!--        <div class="container">-->
<!--            <img src="https://si0.twimg.com/profile_images/1368153646/HOCKERS_copy_normal.png" alt="Gary Hockin Blog"-->
<!--                 class="img-polaroid pull-left" id="nav-portrait"/>-->
<!--            <a class="brand"-->
<!--               href="--><!--">-->
<!--</a>-->
<!---->
<!--            <form class="pull-right navbar-search">-->
<!--                <input type="text" class="search-query" placeholder="Search">-->
<!--            </form>-->
<!--        </div>-->
<!---->
<!--    </div>-->
<!---->
<!--</div>-->

<div class="container">
    <div class="hero-unit">
        <img src="https://si0.twimg.com/profile_images/1368153646/HOCKERS_copy.png" alt="Gary Hockin" width="175"
             height="175" align="right" class="img-polaroid" id="hero-portrait"/>

        <h1><a href="/">Gary Hockin Blog</a></h1>

        <p>Technical musings on PHP, specifically Zend Framework (1 and 2)</p>
    </div>

    <div class="row">
        <div class="span9">
            <p class="hidden">In my first post below, I covered how to create a FC plugin to ensure that a user is authenticated when they access every controller.</p>

<h1>Setting view variables from within a FC Plugin</h1>

<p>In my first post below, I covered how to create a FC plugin to ensure that a user is authenticated when they access every controller.</p>

<p>As part of our layout, we want to include a generic style sheet in each page, and a custom style sheet for each controller to each rendered page. As in the previous post, we wanted effectively to run some code in each and every controller, but did not want to have to include the code in each and every controller. As we already had a FC plugin that was handling the authentication, I decided to modify this to set a view variable that can be accessed from the layout.</p>

<p>Basically, this process takes 3 easy steps…</p>

<ol>
<li>Get an instance of the ViewRenderer</li>
<li>Initialise the view</li>
<li>Set the view variable</li>
</ol>

<p>This is pretty straight forward when you understand what you want to achieve, but took some getting right for me, thanks again to everyone in the #zftalk IRC channel for their patience on this one!</p>

<pre><code>// set a view variable with the controller name for access in the layout
// not strictly to do with authentication but it can sit here as a bonus
// create an instance of the view renderer
$viewRenderer = Zend_Controller_Action_HelperBroker::getStaticHelper('viewRenderer');
// initilaise the view
$viewRenderer-&gt;initView();
// set a view variable to be the controller name
$viewRenderer-&gt;view-&gt;controller = $request-&gt;getControllerName();
</code></pre>

<p>Basically that covers it, the trickiest part for me was learning to use the Zend_Controller_Action_HelperBroker to get the helper I needed to set the view variables. I hope this helps someone.</p>

<p>More reading…</p>

<ul>
<li><a href="http://framework.zend.com/manual/en/zend.controller.basics.html">Zend Framework manual entry on Zend_Controller</a></li>
</ul>
            <hr/>
                            <div id="disqus_thread"></div>
                <script type="text/javascript">
                    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                    var disqus_shortname = 'hockblog'; // required: replace example with your forum shortname

                    /* * * DON'T EDIT BELOW THIS LINE * * */
                    (function() {
                        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

                        </div>
        <div class="span3">
            <div class="well well-small">
                <ul id="latest-blog-posts">
                    <h3>Latest Blog Posts</h3>
                    <li><a href="/zf2-for-zf1-users-part-2"><h4>An Introduction to Zend Framework 2 for the Zend Framework 1 Developer - Part 2</h4><p>28 Sep 2012</p></a></li>
<li><a href="/zf2-for-zf1-users-part-1"><h4>An Introduction to Zend Framework 2 for the Zend Framework 1 Developer - Part 1</h4><p>26 Sep 2012</p></a></li>
<li><a href="/zend-framework-2-REST"><h4>Zend Framework 2 and a Restful API Application</h4><p>29 May 2012</p></a></li>
<li><a href="/zend-framework-2-OAuth2"><h4>ZendOAuth2Client maybe?</h4><p>10 May 2012</p></a></li>
<li><a href="/facebook-fb-connect-streampublish"><h4>FB.Connect.streamPublish – wrestling the demons of the Facebook JS library</h4><p>11 Jun 2010</p></a></li>
                </ul>
            </div>

            <a class="twitter-timeline" href="https://twitter.com/GeeH" data-widget-id="251243211404754944">Tweets by @GeeH</a>
            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

        </div>
    </div>

    <footer>
        <p>&copy; Gary Hockin All rights reserved.</p>
    </footer>

</div>
<!-- /container -->


<script>
    var _gaq = [
        ['_setAccount', 'UA-35128972-1'],
        ['_trackPageview']
    ];
    (function (d, t) {
        var g = d.createElement(t), s = d.getElementsByTagName(t)[0];
        g.src = ('https:' == location.protocol ? '//ssl' : '//www') + '.google-analytics.com/ga.js';
        s.parentNode.insertBefore(g, s)
    }(document, 'script'));
</script>

</body>
</html>

